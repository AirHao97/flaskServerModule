(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-44c7f260"],{"620bd":function(t,e,a){},7160:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",[e("a-card",{attrs:{title:"采购订单管理"}},[e("a-row",{attrs:{gutter:16}},["批量采购模式"==t.mode?e("a-col",{staticStyle:{"max-width":"200px","margin-bottom":"12px"},attrs:{span:24}},[e("a-input",{attrs:{placeholder:"关键字查询..",allowClear:""},on:{pressEnter:t.search},model:{value:t.searchForm.keyWord,callback:function(e){t.$set(t.searchForm,"keyWord",e)},expression:"searchForm.keyWord"}})],1):t._e(),"批量采购模式"==t.mode?e("a-col",{staticStyle:{width:"100px","margin-bottom":"12px"},attrs:{span:24}},[e("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.search}},[t._v("查询")])],1):t._e(),"批量采购模式"==t.mode?e("a-col",{staticStyle:{"max-width":"200px","margin-bottom":"12px","margin-right":"10px"},attrs:{span:24}},[e("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}},t._l(t.options_status,(function(a){return e("a-select-option",{key:a,attrs:{value:a}},[t._v(t._s(a))])})),1)],1):t._e(),e("a-col",{staticStyle:{"max-width":"200px","margin-bottom":"12px","margin-right":"10px"},attrs:{span:24}},[e("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:t.searchForm.purchase_platform,callback:function(e){t.$set(t.searchForm,"purchase_platform",e)},expression:"searchForm.purchase_platform"}},t._l(t.options_platform,(function(a){return e("a-select-option",{key:a,attrs:{value:a}},[t._v(t._s(a))])})),1)],1),"批量采购模式"==t.mode?e("a-col",{staticStyle:{"max-width":"200px","margin-bottom":"12px","margin-right":"10px"},attrs:{span:24}},[e("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:t.searchForm.is_ask,callback:function(e){t.$set(t.searchForm,"is_ask",e)},expression:"searchForm.is_ask"}},t._l(t.options_is_ask,(function(a){return e("a-select-option",{key:a,attrs:{value:a}},[t._v(t._s(a))])})),1)],1):t._e(),e("a-col",{staticStyle:{width:"100px","margin-bottom":"12px","margin-right":"40px"},attrs:{span:24}},[e("a-button",{attrs:{type:"primary",icon:"edit"},on:{click:t.changeMode}},[t._v(t._s(t.mode))])],1),"批量采购模式"==t.mode?e("a-col",{staticStyle:{width:"100px","margin-bottom":"12px","margin-right":"60px"},attrs:{span:24}},[e("a-button",{attrs:{type:"primary",icon:"edit"},on:{click:t.updatePurchaseOrder}},[t._v("更新待采购订单")])],1):t._e(),"批量采购模式"==t.mode?e("a-col",{staticStyle:{width:"100px","margin-bottom":"12px","margin-right":"60px"},attrs:{span:24}},[e("a-button",{attrs:{type:"primary",icon:"edit"},on:{click:t.updatePurchaseOrdersIn1688}},[t._v("1688订单信息同步")])],1):t._e()],1),"审阅模式"==t.mode&&"1688"==t.searchForm.purchase_platform?e("a-row",{staticStyle:{display:"flex","align-items":"center"},attrs:{gutter:16}},[e("a-col",{staticStyle:{width:"100px","margin-bottom":"12px"},attrs:{span:24}},[e("span",[t._v("供货商列表：")])]),e("a-col",{staticStyle:{"margin-bottom":"12px"},attrs:{span:24}},t._l(t.supplier_names,(function(a){return e("a-button",{key:a,class:{"selected-supplier":t.searchForm.supplier_name==a},staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.getDataWithSupplier(a)}}},[t._v(" "+t._s(a)+" ")])})),1)],1):t._e(),"审阅模式"==t.mode&&"1688"==t.searchForm.purchase_platform?e("a-row",{staticStyle:{display:"flex","align-items":"center"},attrs:{gutter:16}},[e("a-col",{staticStyle:{"max-width":"400px","margin-bottom":"12px"},attrs:{span:24}},[e("a-input",{attrs:{placeholder:"根据供应商添加采购订单号",allowClear:""},on:{pressEnter:t.fillThePurchaseIdToAllOrder},model:{value:t.postingNumber,callback:function(e){t.postingNumber=e},expression:"postingNumber"}})],1),e("a-col",{staticStyle:{width:"100px","margin-bottom":"12px"},attrs:{span:24}},[e("a-button",{attrs:{type:"primary",icon:"edit"},on:{click:t.fillThePurchaseIdToAllOrder}},[t._v("确定")])],1),e("a-col",{staticStyle:{width:"100px","margin-bottom":"12px","margin-right":"60px"},attrs:{span:24}},[e("a-button",{attrs:{type:"primary",icon:"edit"},on:{click:t.buyPurchaseProductIn1688}},[t._v("一键采购")])],1)],1):t._e(),"审阅模式"!=t.mode||"pdd"!=t.searchForm.purchase_platform&&"线下"!=t.searchForm.purchase_platform?t._e():e("a-row",{staticStyle:{display:"flex","align-items":"center"},attrs:{gutter:16}},[e("a-col",{staticStyle:{"max-width":"400px","margin-bottom":"12px"},attrs:{span:24}},[e("a-input",{attrs:{placeholder:"根据勾选框批量添加采购订单号",allowClear:""},on:{pressEnter:t.handleSelectedRows},model:{value:t.postingNumber,callback:function(e){t.postingNumber=e},expression:"postingNumber"}})],1),e("a-col",{staticStyle:{width:"100px","margin-bottom":"12px"},attrs:{span:24}},[e("a-button",{attrs:{type:"primary",icon:"edit"},on:{click:t.handleSelectedRows}},[t._v("确定")])],1)],1),e("a-row",{staticStyle:{"margin-top":"12px"}},[e("a-table",{attrs:{size:"small",columns:t.columns,dataSource:t.items,rowKey:"id",loading:t.loading,pagination:t.pagination,rowSelection:t.rowSelection},on:{change:t.tableChange},scopedSlots:t._u([{key:"posting_numbers",fn:function(a,s){return e("div",{},t._l(JSON.parse(s.posting_numbers),(function(a,s){return e("div",{key:s+100},[e("span",{staticStyle:{"font-weight":"700"}},[t._v(t._s(s+1)+".")]),e("span",{staticStyle:{color:"green"}},[t._v(" "+t._s(a.value)+" ")]),e("span",{staticStyle:{"margin-left":"20px","font-weight":"700"}},[t._v("状态：")]),e("span",{staticStyle:{color:"red"}},[t._v(" "+t._s(a.signed)+" ")]),e("hr",{staticStyle:{"margin-top":"0"}})])})),0)}},{key:"is_back",fn:function(a,s){return e("div",{},[e("div",[e("span",[t._v(" "+t._s(JSON.parse(s.error_words)?0==JSON.parse(s.error_words).length?"无对话":"运营"==JSON.parse(s.error_words)[JSON.parse(s.error_words).length-1].role?"未处理":"已处理":"无对话")+" ")])])])}},{key:"system_product",fn:function(a,s){return e("div",{},[s.system_product?e("div",[e("span",[t._v(" SKU: ")]),t._v(" "),e("span",{staticStyle:{color:"red"}},[t._v(" "+t._s(s.system_product.system_sku)+" ")]),e("span",[t._v(" 供应商: ")]),t._v(" "),e("span",{staticStyle:{color:"green"}},[t._v(t._s(s.system_product.supplier_name))])]):t._e()])}},{key:"system_product.purchase_link",fn:function(a,s){return e("div",{},[e("div",t._l(JSON.parse(s.system_product.purchase_link),(function(a,s){return e("div",{key:s+100},[e("span",[t._v(t._s(s+1)+"：")]),e("a",{attrs:{href:a.link,target:"_blank"}},[t._v(" "+t._s(`链接${s+1}号`)+" ")]),e("span",{staticStyle:{color:"red"}},[t._v(" "+t._s(a.msg)+" ")]),e("hr")])})),0)])}},{key:"action",fn:function(a,s){return e("div",{},[e("a-button-group",[e("a-button",{attrs:{icon:"edit",size:"small"},on:{click:function(e){return t.openAddFormModal(s)}}},[t._v("添加单号")]),e("a-button",{attrs:{icon:"edit",size:"small"},on:{click:function(e){return t.openFormModal(s)}}},[t._v("修改")]),e("a-popconfirm",{attrs:{title:"确定删除吗"},on:{confirm:function(e){return t.destroy(s.id)}}},[e("a-button",{attrs:{type:"danger",icon:"delete",size:"small"}},[t._v("作废")])],1)],1)],1)}}])})],1)],1),e("form-modal",{attrs:{form:t.targetItem},on:{update:t.update},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}}),e("AddPurchaseId",{attrs:{form:t.targetItem},on:{update:t.update},model:{value:t.AddPurchaseVisible,callback:function(e){t.AddPurchaseVisible=e},expression:"AddPurchaseVisible"}})],1)},r=[],i=(a("a573"),a("f87e")),o=a("f64c"),n={name:"PurchaseOrder",components:{FormModal:()=>a.e("chunk-1ce58598").then(a.bind(null,"0062")),AddPurchaseId:()=>a.e("chunk-637d88e6").then(a.bind(null,"289b"))},data(){return{columns:[{title:"留言",dataIndex:"is_back",scopedSlots:{customRender:"is_back"}},{title:"采购单ID",dataIndex:"id",width:150},{title:"采购单号",dataIndex:"purchase_id"},{title:"国内运单号",dataIndex:"posting_numbers",scopedSlots:{customRender:"posting_numbers"}},{title:"待采购量",dataIndex:"wait_for_purchase_quantity"},{title:"在篮量",dataIndex:"in_basket_quantity"},{title:"在途量",dataIndex:"in_transit_quantity"},{title:"库存量",dataIndex:"stock_quantity"},{title:"出库量",dataIndex:"out_stock_quantity"},{title:"丢失量",dataIndex:"loss_quantity"},{title:"采购价格",dataIndex:"price"},{title:"运费",dataIndex:"shipping_fee"},{title:"退货费用",dataIndex:"back_fee"},{title:"物流状态",dataIndex:"logistics_status"},{title:"采购平台",dataIndex:"purchase_platform"},{title:"采购状态",dataIndex:"status"},{title:"打包留言",dataIndex:"packer_msg"},{title:"采购平台状态",dataIndex:"platform_status"},{title:"运营咨询中",dataIndex:"is_error",customRender:t=>t?"是":"否"},{title:"系统内商品",dataIndex:"system_product",scopedSlots:{customRender:"system_product"}},{title:"采购链接",dataIndex:"system_product.purchase_link",scopedSlots:{customRender:"system_product.purchase_link"}},{title:"创建时间",dataIndex:"create_time"},{title:"添加采购单时间",dataIndex:"fill_purchase_id_time"},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"},width:"156px"}],searchForm:{start:0,limit:15,keyWord:"",status:"全部",purchase_platform:"全部",is_ask:"全部",supplier_name:""},pagination:{current:1,total:0,pageSize:15},loading:!1,items:[],visible:!1,AddPurchaseVisible:!1,targetItem:{},form:{},importLoading:!1,options_status:["全部","待采购","运输中","已完成","有异常","已作废"],options_platform:["全部","1688","pdd","线下"],options_is_ask:["全部","咨询中","未咨询"],supplier_names:[],mode:"批量采购模式",postingNumber:"",selectedRowKeys:[],selectedRows:[]}},computed:{rowSelection(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},watch:{"searchForm.purchase_platform"(t,e){this.loading=!0,"批量采购模式"==this.mode?(this.searchForm.start=0,this.searchForm.limit=15,this.pagination={current:1,total:0,pageSize:15,position:"bottom"},this.list()):"审阅模式"==this.mode&&(this.searchForm.start=0,this.searchForm.limit=1e3,this.pagination={current:1,total:0,pageSize:1e3,position:"none"},Object(i["i"])(this.searchForm).then(t=>{this.supplier_names=t.data.data,this.searchForm.supplier_name=t.data.data?t.data.data[0]:"",this.list()}).finally(()=>{this.loading=!1}))},"searchForm.status"(t,e){this.loading=!0,"批量采购模式"==this.mode?(this.searchForm.start=0,this.searchForm.limit=15,this.pagination={current:1,total:0,pageSize:15,position:"bottom"},this.list()):"审阅模式"==this.mode&&(this.searchForm.start=0,this.searchForm.limit=1e3,this.pagination={current:1,total:0,pageSize:1e3,position:"none"},Object(i["i"])(this.searchForm).then(t=>{this.supplier_names=t.data.data,this.searchForm.supplier_name=t.data.data?t.data.data[0]:"",this.list()}).finally(()=>{this.loading=!1}))},"searchForm.is_ask"(t,e){this.loading=!0,"批量采购模式"==this.mode?(this.searchForm.start=0,this.searchForm.limit=15,this.pagination={current:1,total:0,pageSize:15,position:"bottom"},this.list()):"审阅模式"==this.mode&&(this.searchForm.start=0,this.searchForm.limit=1e3,this.pagination={current:1,total:0,pageSize:1e3,position:"none"},Object(i["i"])(this.searchForm).then(t=>{this.supplier_names=t.data.data,this.searchForm.supplier_name=t.data.data?t.data.data[0]:"",this.list()}).finally(()=>{this.loading=!1}))}},methods:{initialize(){this.list()},list(){this.loading=!0,"批量采购模式"==this.mode?Object(i["g"])(this.searchForm).then(t=>{this.pagination.total=t.data.count,this.items=t.data.data}).finally(()=>{this.loading=!1}):"1688"==this.searchForm.purchase_platform?this.searchForm.supplier_name?Object(i["f"])(this.searchForm).then(t=>{this.items=t.data.data}).finally(()=>{this.loading=!1}):(o["a"].success("暂无需要采购的订单！"),this.changeMode()):Object(i["g"])(this.searchForm).then(t=>{this.pagination.total=t.data.count,this.items=t.data.data}).finally(()=>{this.loading=!1})},update(){this.AddPurchaseVisible=!1,this.visible=!1,this.list()},search(){this.searchForm.start=0,this.pagination.current=1,this.list()},openFormModal(t){this.targetItem={...t},this.visible=!0},openAddFormModal(t){this.targetItem={...t},this.AddPurchaseVisible=!0},destroy(t){Object(i["c"])({purchase_order_id:t}).then(t=>{this.$message.success(t.msg),this.list()})},tableChange(t,e,a){this.searchForm.start=(t.current-1)*this.pagination.pageSize,this.pagination.current=t.current,this.list()},changeMode(){this.searchForm.start=0,this.pagination.current=1,"批量采购模式"==this.mode?(this.mode="审阅模式",this.searchForm.limit=1e3,this.pagination.pageSize=1e4,this.pagination.position="none",this.loading=!0,Object(i["i"])(this.searchForm).then(t=>{this.supplier_names=t.data.data,this.searchForm.supplier_name=t.data.data?t.data.data[0]:"",this.list()}).finally(()=>{this.loading=!1})):"审阅模式"==this.mode&&(this.mode="批量采购模式",this.searchForm.limit=15,this.pagination.pageSize=15,this.pagination.position="bottom",this.list())},getDataWithSupplier(t){this.searchForm.supplier_name=t,this.list()},fillThePurchaseIdToAllOrder(){this.postingNumber?(this.loading=!0,Object(i["e"])({purchase_order_ids:this.items.map(t=>t.id),purchase_id:this.postingNumber}).then(t=>{this.postingNumber="",o["a"].success(t.msg),Object(i["i"])(this.searchForm).then(t=>{this.supplier_names=t.data.data,this.searchForm.supplier_name=t.data.data?t.data.data[0]:"",this.list()}).finally(()=>{this.loading=!1})})):o["a"].error("采购订单号不能为空")},updatePurchaseOrder(){Object(i["l"])().then(t=>{o["a"].success(t.msg),this.list()})},updatePurchaseOrdersIn1688(){Object(i["m"])().then(t=>{o["a"].success(t.msg),this.list()})},buyPurchaseProductIn1688(){Object(i["b"])({purchase_order_msgs:this.items}).then(t=>{o["a"].success(t.msg),Object(i["i"])(this.searchForm).then(t=>{this.supplier_names=t.data.data,this.searchForm.supplier_name=t.data.data?t.data.data[0]:"",this.list()}).finally(()=>{this.loading=!1})})},onSelectChange(t,e){this.selectedRowKeys=t,this.selectedRows=e},handleSelectedRows(){const t=this.selectedRows.map(t=>t.id);console.log(t),this.postingNumber?(this.loading=!0,Object(i["e"])({purchase_order_ids:t,purchase_id:this.postingNumber}).then(t=>{this.postingNumber="",o["a"].success(t.msg),this.list()}).finally(()=>{this.loading=!1})):o["a"].error("采购订单号不能为空")}},mounted(){this.initialize()},activated(){this.initialize()}},c=n,l=(a("ce9c"),a("2877")),d=Object(l["a"])(c,s,r,!1,null,"0de2f1b9",null);e["default"]=d.exports},ce9c:function(t,e,a){"use strict";a("620bd")},f87e:function(t,e,a){"use strict";a.d(e,"g",(function(){return r})),a.d(e,"i",(function(){return i})),a.d(e,"f",(function(){return o})),a.d(e,"l",(function(){return n})),a.d(e,"j",(function(){return c})),a.d(e,"k",(function(){return l})),a.d(e,"e",(function(){return d})),a.d(e,"d",(function(){return h})),a.d(e,"c",(function(){return p})),a.d(e,"m",(function(){return u})),a.d(e,"b",(function(){return m})),a.d(e,"n",(function(){return _})),a.d(e,"h",(function(){return g})),a.d(e,"a",(function(){return b}));var s=a("b775");function r(t){return Object(s["a"])({url:"/purchase_order/getData",method:"get",params:t})}function i(t){return Object(s["a"])({url:"/purchase_order/getWaitForPurchaseOrderSupplier",method:"get",params:t})}function o(t){return Object(s["a"])({url:"/purchase_order/getDataInPurchaseMode",method:"get",params:t})}function n(t){return Object(s["a"])({url:"/purchase_order/updateData",method:"post",data:t})}function c(t){return Object(s["a"])({url:"/purchase_order/modifyData",method:"post",data:t})}function l(t){return Object(s["a"])({url:"/purchase_order/operationModifyData",method:"post",data:t})}function d(t){return Object(s["a"])({url:"/purchase_order/fillThePurchaseIdForPurchaseOrders",method:"post",data:t})}function h(t){return Object(s["a"])({url:"/purchase_order/fillThePurchaseIdForPurchaseOrder",method:"post",data:t})}function p(t){return Object(s["a"])({url:"/purchase_order/cancleThePurchaseOrder",method:"post",data:t})}function u(t){return Object(s["a"])({url:"/purchase_order/updatePurchaseOrdersIn1688WithAPI",method:"post",data:t})}function m(t){return Object(s["a"])({url:"/purchase_order/buyPurchaseProductIn1688WithAPI",method:"post",data:t})}function _(t){return Object(s["a"])({url:"/pic/upload",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}})}function g(t){return Object(s["a"])({url:"/purchase_product/getData",method:"get",params:t})}function b(t){return Object(s["a"])({url:"/purchase_product/addData",method:"post",data:t})}}}]);
//# sourceMappingURL=chunk-44c7f260.482f46c2.js.map