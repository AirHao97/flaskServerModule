{"version":3,"sources":["webpack:///./src/api/packer.js","webpack:///./src/views/packer/stock_out/index.vue","webpack:///src/views/packer/stock_out/index.vue","webpack:///./src/views/packer/stock_out/index.vue?a88a","webpack:///./src/views/packer/stock_out/index.vue?8cd7"],"names":["getInTransitPurchaseOrderData","params","request","url","method","getThePostingOfPurchaseOrder","data","signTheSystemProductsOfPurchaseOrder","getStockPreparedPendingOutwardOzonOrderData","getOrderForDispatch","stockOutPurchaseProductWithPurchaseProductId","getDataWithOzonOrderId","stockOutPurchaseProductInOzonOrder","checkOzonOrderWeight","labelTheOverWeightOzonOrder","uploadTheWeight","addPackage","printPackage","render","_vm","this","_c","_self","attrs","staticStyle","on","search","model","value","searchForm","keyWord","callback","$$v","$set","expression","_v","calculateCanBeStockOutOzonOrder","changeMode","_s","mode","openCheckWeightForm","ref","openFormModal","purchase_product_id","_e","columns","items","loading","pagination","tableChange","scopedSlots","_u","key","fn","text","record","_l","products","product","index","offer_id","quantity","system_products","system_product","id","system_sku","targetItem","package_sku","update","visible","checkWeightVisible","staticRenderFns","name","components","FormModal","CheckWeightFormModal","title","dataIndex","width","customRender","item","moment","format","start","limit","system_status","current","total","pageSize","form","importLoading","iframe","computed","methods","initialize","list","then","count","finally","res","type","message","success","msg","pdfBase64","pdfBlob","base64ToBlob","pdfUrl","URL","createObjectURL","document","createElement","body","appendChild","base64","byteCharacters","atob","byteArrays","offset","length","slice","byteNumbers","Array","i","charCodeAt","push","Uint8Array","Blob","style","display","src","onload","contentWindow","focus","print","$nextTick","$refs","error","filters","sorter","mounted","activated","component"],"mappings":"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","file":"static/js/chunk-74f87742.afab3e7f.js","sourcesContent":["import request from '@/utils/request';\r\n\r\n// 打包获取所有的 状态为 运输中 的采购订单\r\nexport function getInTransitPurchaseOrderData(params) {\r\n  return request({ url: `/purchase_order/getInTransitPurchaseOrderData`, method: 'get', params })\r\n}\r\n\r\n// 管理员及打包 返回所有包含此运单号的采购单产品信息 \r\nexport function getThePostingOfPurchaseOrder(data) {\r\n  return request({ url: `/purchase_order/getThePostingOfPurchaseOrder`, method: 'post', data })\r\n}\r\n\r\n// 管理员及打包 入库包含此系统中产品的 采购单 并填写到货数量\r\nexport function signTheSystemProductsOfPurchaseOrder(data) {\r\n  return request({ url: `/purchase_order/signTheSystemProductsOfPurchaseOrder`, method: 'post', data })\r\n}\r\n\r\n// ----------------------------------------------------\r\n\r\n// 打包获取所有状态为 已备货待出库 的 ozon订单\r\nexport function getStockPreparedPendingOutwardOzonOrderData(params) {\r\n  return request({ url: `/ozon_order/getStockPreparedPendingOutwardOzonOrderData`, method: 'get', params })\r\n}\r\n\r\n// 计算获取所有可以进行打包的ozon订单\r\nexport function getOrderForDispatch(data) {\r\n  return request({ url: `/ozon_order/getOrderForDispatch`, method: 'post', data })\r\n}\r\n\r\n// 根据采购产品id 出库采购产品和订单 如果订单只包含这一个产品 直接出库 并打印单子  如果包含多个产品 显示剩余需要出库的产品\r\nexport function stockOutPurchaseProductWithPurchaseProductId(data) {\r\n  return request({ url: `/ozon_order/stockOutPurchaseProductWithPurchaseProductId`, method: 'post', data })\r\n}\r\n\r\n//根据id获取订单数据\r\nexport function getDataWithOzonOrderId(data) {\r\n  return request({ url: `/ozon_order/getDataWithOzonOrderId`, method: 'post', data })\r\n}\r\n\r\n// 根据采购产品id 出库采购产品和订单 如果订单只包含这一个产品 直接出库  如果包含多个产品 显示剩余需要出库的产品\r\nexport function stockOutPurchaseProductInOzonOrder(data) {\r\n  return request({ url: `/ozon_order/stockOutPurchaseProductInOzonOrder`, method: 'post', data })\r\n}\r\n\r\n// ----------------------------------------------------\r\n// 称重检查\r\nexport function checkOzonOrderWeight(data) {\r\n  return request({ url: `/ozon_order/checkOzonOrderWeight`, method: 'post', data })\r\n}\r\n// 异常订单上报运营\r\nexport function labelTheOverWeightOzonOrder(data) {\r\n  return request({ url: `/ozon_order/labelTheOverWeightOzonOrder`, method: 'post', data })\r\n}\r\n\r\n// 称重正常 绑定重量\r\nexport function uploadTheWeight(data) {\r\n  return request({ url: `/ozon_order/uploadTheWeight`, method: 'post', data })\r\n}\r\n\r\n\r\n// ----------------------------------------------------\r\n// 添加麻袋\r\nexport function addPackage(data) {\r\n  return request({ url: `/package/addData`, method: 'post', data })\r\n}\r\n\r\n// 打印麻袋标签\r\nexport function printPackage(data) {\r\n  return request({ url: `/package/printPackage`, method: 'post', data })\r\n}\r\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('a-card',{attrs:{\"title\":\"ozon订单管理\"}},[_c('a-row',{attrs:{\"gutter\":16}},[_c('a-col',{staticStyle:{\"max-width\":\"200px\",\"margin-bottom\":\"12px\"},attrs:{\"span\":24}},[_c('a-input',{attrs:{\"placeholder\":\"关键字查询..\",\"allowClear\":\"\"},on:{\"pressEnter\":_vm.search},model:{value:(_vm.searchForm.keyWord),callback:function ($$v) {_vm.$set(_vm.searchForm, \"keyWord\", $$v)},expression:\"searchForm.keyWord\"}})],1),_c('a-col',{staticStyle:{\"width\":\"100px\",\"margin-bottom\":\"12px\"},attrs:{\"span\":24}},[_c('a-button',{attrs:{\"type\":\"primary\",\"icon\":\"search\"},on:{\"click\":_vm.search}},[_vm._v(\"查询\")])],1),_c('a-col',{staticStyle:{\"width\":\"100px\",\"margin-bottom\":\"12px\",\"margin-right\":\"70px\"},attrs:{\"span\":24}},[_c('a-button',{attrs:{\"type\":\"primary\",\"icon\":\"edit\"},on:{\"click\":_vm.calculateCanBeStockOutOzonOrder}},[_vm._v(\"计算可出库订单\")])],1),_c('a-col',{staticStyle:{\"width\":\"100px\",\"margin-bottom\":\"12px\",\"margin-right\":\"70px\"},attrs:{\"span\":24}},[_c('a-button',{attrs:{\"type\":\"primary\",\"icon\":\"search\"},on:{\"click\":_vm.changeMode}},[_vm._v(_vm._s(_vm.mode))])],1),_c('a-col',{staticStyle:{\"width\":\"100px\",\"margin-bottom\":\"12px\"},attrs:{\"span\":24}},[_c('a-button',{attrs:{\"type\":\"primary\",\"icon\":\"search\"},on:{\"click\":_vm.openCheckWeightForm}},[_vm._v(\"称重检查\")])],1)],1),(_vm.mode == '关闭出库模式')?_c('a-row',{attrs:{\"gutter\":16}},[_c('a-col',{staticStyle:{\"width\":\"400px\",\"margin-bottom\":\"12px\"},attrs:{\"span\":24}},[_c('a-input',{ref:\"purchase_product_id\",attrs:{\"placeholder\":\"采购商品输入..\",\"allowClear\":\"\"},on:{\"pressEnter\":_vm.openFormModal},model:{value:(_vm.purchase_product_id),callback:function ($$v) {_vm.purchase_product_id=$$v},expression:\"purchase_product_id\"}})],1),_c('a-col',{staticStyle:{\"width\":\"100px\",\"margin-bottom\":\"12px\"},attrs:{\"span\":24}},[_c('a-button',{attrs:{\"type\":\"primary\",\"icon\":\"search\"},on:{\"click\":_vm.openFormModal}},[_vm._v(\"确定\")])],1)],1):_vm._e(),_c('a-row',{staticStyle:{\"margin-top\":\"12px\"}},[_c('a-table',{attrs:{\"size\":\"small\",\"columns\":_vm.columns,\"dataSource\":_vm.items,\"rowKey\":\"id\",\"loading\":_vm.loading,\"pagination\":_vm.pagination},on:{\"change\":_vm.tableChange},scopedSlots:_vm._u([{key:\"is_active\",fn:function(value){return _c('div',{},[_c('a-tag',{attrs:{\"color\":value ? 'green' : 'red'}},[_vm._v(_vm._s(value ? '激活' : '冻结'))])],1)}},{key:\"products\",fn:function(text, record){return _c('div',{},_vm._l((record.products),function(product,index){return _c('div',{key:index+100,staticStyle:{\"display\":\"flex\"}},[_c('span',[_vm._v(\" \"+_vm._s(index+1)+\". \")]),_c('span',[_vm._v(\" offer_id: \")]),_vm._v(\" \"),_c('span',{staticStyle:{\"color\":\"red\"}},[_vm._v(\" \"+_vm._s(product.offer_id)+\" \")]),_c('span',[_vm._v(\" 数量: \")]),_vm._v(\" \"),_c('span',{staticStyle:{\"color\":\"skyblue\"}},[_vm._v(_vm._s(product.quantity))]),_c('div',{staticStyle:{\"display\":\"flex\",\"flex-direction\":\"column\",\"margin-left\":\"20px\"}},_vm._l((product.system_products),function(system_product){return _c('div',{key:system_product.id},[_c('span',[_vm._v(\" 系统内sku: \")]),_c('span',{staticStyle:{\"color\":\"red\"}},[_vm._v(\" \"+_vm._s(system_product.system_sku)+\" \")])])}),0),_c('hr')])}),0)}}])})],1)],1),_c('form-modal',{attrs:{\"form\":_vm.targetItem,\"package_sku\":_vm.package_sku},on:{\"update\":_vm.update},model:{value:(_vm.visible),callback:function ($$v) {_vm.visible=$$v},expression:\"visible\"}}),_c('CheckWeightFormModal',{attrs:{\"form\":_vm.targetItem},on:{\"update\":_vm.update},model:{value:(_vm.checkWeightVisible),callback:function ($$v) {_vm.checkWeightVisible=$$v},expression:\"checkWeightVisible\"}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <a-card title=\"ozon订单管理\">\r\n      <a-row :gutter=\"16\">\r\n        <a-col :span=\"24\" style=\"max-width: 200px; margin-bottom: 12px;\">\r\n          <a-input v-model=\"searchForm.keyWord\" placeholder=\"关键字查询..\" allowClear @pressEnter=\"search\" />\r\n        </a-col>\r\n        <a-col :span=\"24\" style=\"width: 100px; margin-bottom: 12px;\">\r\n          <a-button type=\"primary\" icon=\"search\" @click=\"search\">查询</a-button>\r\n        </a-col>\r\n        <a-col :span=\"24\" style=\"width: 100px; margin-bottom: 12px; margin-right: 70px;\">\r\n          <a-button type=\"primary\" icon=\"edit\" @click=\"calculateCanBeStockOutOzonOrder\">计算可出库订单</a-button>\r\n        </a-col>\r\n        <a-col :span=\"24\" style=\"width: 100px; margin-bottom: 12px; margin-right: 70px;\">\r\n          <a-button type=\"primary\" icon=\"search\" @click=\"changeMode\">{{mode}}</a-button>\r\n        </a-col>\r\n        <a-col :span=\"24\" style=\"width: 100px; margin-bottom: 12px;\">\r\n          <a-button type=\"primary\" icon=\"search\" @click=\"openCheckWeightForm\">称重检查</a-button>\r\n        </a-col>\r\n      </a-row>\r\n\r\n      <a-row :gutter=\"16\" v-if=\"mode == '关闭出库模式'\">\r\n\r\n        <a-col :span=\"24\" style=\"width: 400px; margin-bottom: 12px;\">\r\n          <a-input ref=\"purchase_product_id\" v-model=\"purchase_product_id\" placeholder=\"采购商品输入..\" allowClear @pressEnter=\"openFormModal\" />\r\n        </a-col> \r\n\r\n        <a-col :span=\"24\" style=\"width: 100px; margin-bottom: 12px;\">\r\n          <a-button type=\"primary\" icon=\"search\" @click=\"openFormModal\">确定</a-button>\r\n        </a-col>\r\n      </a-row>\r\n\r\n      <a-row style=\"margin-top: 12px;\">\r\n        <a-table size=\"small\" :columns=\"columns\" :dataSource=\"items\" rowKey=\"id\" :loading=\"loading\" :pagination=\"pagination\" @change=\"tableChange\">\r\n          <div slot=\"is_active\" slot-scope=\"value\">\r\n            <a-tag :color=\"value ? 'green' : 'red'\">{{value ? '激活' : '冻结'}}</a-tag>\r\n          </div>\r\n          <div slot=\"products\" slot-scope=\"text, record\">\r\n            <div v-for=\" product,index in record.products\" :key=\"index+100\" style=\"display: flex;\">\r\n              <span> {{ index+1 }}. </span>\r\n              <span> offer_id: </span> <span style=\"color: red;\"> {{ product.offer_id }} </span> \r\n              <span> 数量: </span> <span style=\"color: skyblue;\">{{ product.quantity }}</span>\r\n\r\n              <div style=\"display: flex; flex-direction: column; margin-left: 20px;\">\r\n                <div v-for=\"system_product in product.system_products\" :key=\"system_product.id\">\r\n                  <span> 系统内sku: </span> \r\n                  <span style=\"color: red;\"> {{ system_product.system_sku }} </span> \r\n                </div>\r\n              </div>\r\n              <hr>\r\n\r\n            </div>\r\n          </div>\r\n        </a-table>\r\n      </a-row>\r\n    </a-card>\r\n    <form-modal v-model=\"visible\" :form=\"targetItem\" :package_sku=\"package_sku\" @update=\"update\" />\r\n    <CheckWeightFormModal v-model=\"checkWeightVisible\" :form=\"targetItem\"  @update=\"update\"/>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport moment from 'moment'\r\nimport {getStockPreparedPendingOutwardOzonOrderData,stockOutPurchaseProductWithPurchaseProductId,getOrderForDispatch} from '@/api/packer'\r\nimport { message } from \"ant-design-vue\";\r\n\r\nexport default {\r\n  name: 'OzonOrder',\r\n  components: {\r\n    FormModal: () => import('./FormModal.vue'),\r\n    CheckWeightFormModal: () => import('./CheckWeightFormModal.vue'),\r\n  },\r\n  data() {\r\n    return {\r\n      columns: [\r\n        {\r\n          title: '订单ID',\r\n          dataIndex: 'order_id',\r\n        },\r\n        {\r\n          title: '货件号',\r\n          dataIndex: 'posting_number',\r\n          key: 'posting_number',\r\n          width: '145px'\r\n        },\r\n        {\r\n          title: '国际运单号',\r\n          dataIndex: 'tracking_number',\r\n          key: 'tracking_number',\r\n          width: '145px'\r\n        },\r\n        {\r\n          title: '系统状态',\r\n          dataIndex: 'system_status',\r\n        },\r\n        {\r\n          title: '开始处理时间',\r\n          dataIndex: 'in_process_at',\r\n          customRender: (value, item, index) => {\r\n              return moment(value).format('YYYY-MM-DD HH:mm:ss')\r\n            },\r\n        },\r\n        {\r\n          title: '必须收取时间',\r\n          dataIndex: 'shipment_date',\r\n          customRender: (value, item, index) => {\r\n            return moment(value).format('YYYY-MM-DD HH:mm:ss')\r\n          } \r\n        },\r\n        {\r\n          title: '产品',\r\n          dataIndex: 'products',\r\n          scopedSlots: { customRender: 'products' },\r\n        },\r\n      ],\r\n      searchForm: { start: 0, limit: 15, keyWord: \"\", system_status:\"\" },\r\n      pagination: { current: 1, total: 0, pageSize: 15 },\r\n      loading: false,\r\n      items: [],\r\n\r\n      visible: false,\r\n      checkWeightVisible:false,\r\n      targetItem: {},\r\n      form: {},\r\n      importLoading: false,\r\n\r\n      mode : \"开启出库模式\",\r\n      purchase_product_id:\"\",\r\n      iframe: false\r\n\r\n    };\r\n  },\r\n  computed: {\r\n  },\r\n  methods: {\r\n    initialize() {\r\n      this.list();\r\n    },\r\n    list() {\r\n      this.loading = true;\r\n      getStockPreparedPendingOutwardOzonOrderData(this.searchForm).then(data => {\r\n        this.pagination.total = data.data.count;\r\n        this.items = data.data.data;\r\n      }).finally(() => {\r\n        this.loading = false;\r\n      });\r\n    },\r\n    update() {\r\n      this.visible = false\r\n      this.checkWeightVisible = false\r\n      this.list();\r\n    },\r\n    search() {\r\n      this.searchForm.start = 0;\r\n      this.pagination.current = 1;\r\n      this.list();\r\n    },\r\n    openFormModal() {\r\n      if(this.purchase_product_id){\r\n\r\n        stockOutPurchaseProductWithPurchaseProductId({purchase_product_id:this.purchase_product_id}).then(\r\n          res => {\r\n            if(res.type == \"组合订单\"){\r\n              message.success(res.msg);\r\n              this.targetItem = res.data;\r\n              this.visible = true;\r\n            }else{\r\n              // 触发打印\r\n              const pdfBase64 = res.data;\r\n              const pdfBlob = base64ToBlob(pdfBase64);\r\n              const pdfUrl = URL.createObjectURL(pdfBlob);\r\n\r\n              // 创建并加载 iframe\r\n              if(this.iframe == false){\r\n                this.iframe = document.createElement('iframe');\r\n                document.body.appendChild(this.iframe);\r\n              }\r\n\r\n              let iframe = this.iframe\r\n\r\n              iframe.style.display = 'none'; // 隐藏 iframe\r\n              iframe.src = pdfUrl;\r\n\r\n              iframe.onload = () => {\r\n                iframe.contentWindow.focus();\r\n                iframe.contentWindow.print(); // 触发打印\r\n                message.success(res.msg);\r\n                this.search()\r\n                this.$nextTick(() => {\r\n                  this.$refs.purchase_product_id.focus();\r\n                });\r\n              };\r\n\r\n              // 将 base64 编码的 PDF 转换为 Blob\r\n              function base64ToBlob(base64) {\r\n                const byteCharacters = atob(base64);\r\n                const byteArrays = [];\r\n\r\n                for (let offset = 0; offset < byteCharacters.length; offset += 1024) {\r\n                  const slice = byteCharacters.slice(offset, offset + 1024);\r\n                  const byteNumbers = new Array(slice.length);\r\n                  for (let i = 0; i < slice.length; i++) {\r\n                    byteNumbers[i] = slice.charCodeAt(i);\r\n                  }\r\n                  byteArrays.push(new Uint8Array(byteNumbers));\r\n                }\r\n\r\n                return new Blob(byteArrays, { type: 'application/pdf' });\r\n              }\r\n            }\r\n          }\r\n        )\r\n      }else{\r\n        message.error(\"入库采购商品id不能为空！\")\r\n      }\r\n    },\r\n    tableChange(pagination, filters, sorter) {      \r\n      this.searchForm.start = (pagination.current-1)*this.pagination.pageSize;\r\n      this.pagination.current = pagination.current;\r\n      this.list();\r\n    },\r\n    changeMode(){\r\n      if(this.mode == \"开启出库模式\"){\r\n        this.mode = \"关闭出库模式\"\r\n        this.$nextTick(() => {\r\n          this.$refs.purchase_product_id.focus();\r\n        });\r\n      }else {\r\n        this.mode = \"开启出库模式\"\r\n      }\r\n    },\r\n    calculateCanBeStockOutOzonOrder(){\r\n      getOrderForDispatch().then(\r\n        res => {\r\n          message.success(res.msg)\r\n          this.search()\r\n        }\r\n      )\r\n    },\r\n    openCheckWeightForm(){\r\n      this.targetItem = {};\r\n      this.checkWeightVisible = true;\r\n    }\r\n  },\r\n  mounted() {\r\n    this.initialize();\r\n  },\r\n  activated() {\r\n    this.initialize();\r\n  },\r\n}\r\n</script>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=118067b0\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}